
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The increasing threat of wildfires in the U.S.A. &#8212; My Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint single-page" id="site-navigation">
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/US_Wildfires_Analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/US_Wildfires_Analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-the-dataset">
   Overview of the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-growing-strength-of-large-wildfires">
   The growing strength of large wildfires
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-look-at-the-largest-fires-from-2000-2019">
   A look at the largest fires from 2000-2019
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparing-wildfire-occurences-in-alaska-and-the-continential-u-s-a">
   Comparing wildfire occurences in Alaska and the Continential U.S.A.
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The increasing threat of wildfires in the U.S.A.</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-the-dataset">
   Overview of the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-growing-strength-of-large-wildfires">
   The growing strength of large wildfires
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-look-at-the-largest-fires-from-2000-2019">
   A look at the largest fires from 2000-2019
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparing-wildfire-occurences-in-alaska-and-the-continential-u-s-a">
   Comparing wildfire occurences in Alaska and the Continential U.S.A.
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-increasing-threat-of-wildfires-in-the-u-s-a">
<h1>The increasing threat of wildfires in the U.S.A.<a class="headerlink" href="#the-increasing-threat-of-wildfires-in-the-u-s-a" title="Permalink to this headline">#</a></h1>
<p>by Joey Rucska</p>
<p>February 2023</p>
<p>One of the most visible and dramatic outcomes of climate change in the United States is the growing frequency of massive wildfires. The west coast region and Alaska are particularly susceptible. In recent years there have been several dramatic events where smoke turned entire skies orange and opaque, like in the image below. The dangers of wildfires are obvious. They threaten infrastructure, ecosystems, and human lives. Understanding how wildfires activity is changing is a crucial part of mitigating their future impacts.</p>
<p>On this webpage I present an analysis of a publicly available <a class="reference external" href="https://www.kaggle.com/datasets/behroozsohrabi/us-wildfire-records-6th-edition">dataset</a> cataloguing 2.3 million wildfires within the U.S.A. between 1992 and 2020. I show that the occurence of fires is cyclical–oscillating between relatively heavy and low fire abundances with a cycle length or period of 2-3 years. Underlying the oscillations is an increasing trend in the typical fire size and the total annual surface area affected by fires. Approximately 190,000 additional acres per year are affected by fires, on average, adding to annual totals that already amount to a few-several millions of acres. Large fires are becoming more frequent quicker than smaller fires. During years of peak activity between 2015-2020, there was nearly double the total acreage affected by large fires when compared to the average over the 1992-2020 period. Lastly, a spatial map of wildfire activity demonstrates that the western coast of the conintental U.S. and Alaska are more suspectible to wildfires than other regions.</p>
<p>The Jupyter Notebook for this project is available on <a class="reference external" href="https://github.com/rucskajj/Data-Science-Projects/tree/main/USWildfires00-20">Github</a>.</p>
<img src="https://live.staticflickr.com/65535/50324593222_7432c54dce_b.jpg" alt="The Day The Sun Didn't Rise | Christopher Michel" width="700" />
<p>“The Day The Sun Didn’t Rise” by Christopher Michel, via <a class="reference external" href="https://flic.kr/p/2jEZMCE">Flickr</a>, reproduced without alterations under Creative Commons License (<a class="reference external" href="https://creativecommons.org/licenses/by-nc-nd/2.0/">CC BY-NC-ND 2.0</a>). All right belongs to the artist.</p>
<section id="overview-of-the-dataset">
<h2>Overview of the dataset<a class="headerlink" href="#overview-of-the-dataset" title="Permalink to this headline">#</a></h2>
<p>Each entry in the data set includes the date the fire was discovered, the size of the fire damage in acres, the <a class="reference external" href="https://www.nwcg.gov/term/glossary/size-class-of-fire">letter class</a> of the size of the fire (A-G), the cause of the fire, and the approximate latitude and longitude of the fire, among several other things.</p>
<p>Looking at the distribution of all fire sizes from 1992-2020, plotted below, we see there are many entries for fires &lt; 10 acres. The distribution at this small size end features narrow peaks that are most definitely as result of manual rounding to convenient, integer fractions (e.g. 1 acre, 1/2, 1/4, 2, 3, etc.). Thus, <strong>for the rest of this analysis, I am only going to look at the fires above 100 acres (or class D)</strong>, to focus on the fires that are capable of doing the most damage, or potentially growing into catastrophic fires if they are not controlled in time.</p>
<p>In the below figure, the region bounded by the dotted lines in the left panel (fires &gt; 100 acres) is enlarged in the right panel. The fire class letter boundaries are also shown the right panel.</p>
<p>Note, the data on both axes are presented in logarithmic spacing. The high-end fire size distribution is exponential: there are 100 times more 100-acre fires than 100,000-acre fires.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="kn">import</span> <span class="nn">plotting_routines</span> <span class="k">as</span> <span class="nn">pltrs</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;serif&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dir</span> <span class="o">=</span> <span class="s2">&quot;./pandas-dfs/&quot;</span>
<span class="n">df_filename</span> <span class="o">=</span> <span class="s2">&quot;fireyear-to-lat-long.pkl&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">df_dir</span><span class="o">+</span><span class="n">df_filename</span><span class="p">)</span>
<span class="c1">#print(df.head()) # Ordered by Discovery Date</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new pandas df for fire above 100 acres</span>
<span class="n">df_lrg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;DISCOVERY_DOY&#39;</span><span class="p">,</span> <span class="s1">&#39;DISCOVERY_TIME&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;FIRE_SIZE_CLASS&#39;</span><span class="p">,</span> <span class="s1">&#39;LATITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">]]</span>


<span class="c1"># Plot Distributions of Fire Size</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
       <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c96a16&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000000</span><span class="p">])</span>

<span class="c1"># Trace out subset shown in right panel</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="mi">100</span><span class="p">],</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="mi">20000</span><span class="p">],</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">()</span>
<span class="n">xticks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fire size [acres]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution of fire sizes&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c96a16&quot;</span><span class="p">)</span>

<span class="c1"># For labelling the Fire Classes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20000</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fire size [acres]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution of largest fire sizes&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_4_0.png" src="_images/US_Wildfires_Analysis_4_0.png" />
</div>
</div>
<p>One might assume wildfires are more likely to start during the hotter part of the day, and the below plot demonstrates this is true, regardless of whether you look at all fires or just the largest fires. Both distributions (still representing the full 1992-2020 period) peak strongly near 3 in the afternoon.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop/clean any entries with no recorded Time of Day</span>
<span class="n">disctime</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCOVERY_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
<span class="n">disctime_lf</span> <span class="o">=</span> <span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;DISCOVERY_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">])</span>

<span class="n">norm</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1"># 28 years in sample, normalization to get bin values in number of fires per year</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">disctime</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2400</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">hist</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count per year (all fires)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">disctime_lf</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2400</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">hist</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count per year (large fires)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">be</span> <span class="ow">in</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">be</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">230</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2400</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1200</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="mi">2400</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;0:00&quot;</span><span class="p">,</span><span class="s2">&quot;6:00&quot;</span><span class="p">,</span><span class="s2">&quot;12:00&quot;</span><span class="p">,</span><span class="s2">&quot;18:00&quot;</span><span class="p">,</span><span class="s2">&quot;24:00&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time of day&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of number of fires over time of day&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_6_0.png" src="_images/US_Wildfires_Analysis_6_0.png" />
</div>
</div>
<p>There is also a distinct annual fire season–or perhaps two: in early spring from mid-February to the end of May, and then the beginning of June to the end of August.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop/clean any entries with no recorded Time of Day</span>
<span class="n">discday</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCOVERY_DOY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
<span class="n">discday_lf</span> <span class="o">=</span> <span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;DISCOVERY_DOY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="c1"># Mark locations of the months in the days of the year, for vertical lines in the plot</span>
<span class="n">days_in_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span> <span class="c1"># Day in each month, using Feb = 29 days</span>
<span class="n">month_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">days_in_months</span><span class="p">)])</span> <span class="c1"># Make array of bin edges using cumsum</span>
<span class="n">month_ticks</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">month_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">::]</span><span class="o">-</span><span class="n">month_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span><span class="o">+</span><span class="n">month_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span> <span class="c1"># x-axis tick locations</span>

<span class="c1"># Annual fire date actually binned by week, not by month, for the histogram</span>
<span class="n">week_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">372</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">week_bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">366</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">])</span>

<span class="n">norm</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1"># to get bin values in number of fires per year</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">discday</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">week_bins</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">hist</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count per year (all fires)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">discday_lf</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">week_bins</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">stairs</span><span class="p">(</span><span class="n">hist</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count per year (large fires)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>

<span class="c1"># Vertical lines to visualize the months</span>
<span class="k">for</span> <span class="n">mb</span> <span class="ow">in</span> <span class="n">month_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">366</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">month_ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;Jan.&quot;</span><span class="p">,</span><span class="s2">&quot;Feb.&quot;</span><span class="p">,</span><span class="s2">&quot;Mar.&quot;</span><span class="p">,</span><span class="s2">&quot;Apr.&quot;</span><span class="p">,</span><span class="s2">&quot;May&quot;</span><span class="p">,</span><span class="s2">&quot;Jun&quot;</span><span class="p">,</span><span class="s2">&quot;Jul.&quot;</span><span class="p">,</span><span class="s2">&quot;Aug.&quot;</span><span class="p">,</span><span class="s2">&quot;Sep.&quot;</span><span class="p">,</span><span class="s2">&quot;Oct.&quot;</span><span class="p">,</span><span class="s2">&quot;Nov.&quot;</span><span class="p">,</span><span class="s2">&quot;Dec.&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time of year&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of number of fires over time of year&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_8_0.png" src="_images/US_Wildfires_Analysis_8_0.png" />
</div>
</div>
<p>According to this dataset, natural causes (lightning strikes, probably) are the main cause of wildfires. Unfortunately, the 2nd largest contributor is in the unknown “missing data” category, and alarmingly, arson is the 3rd most prominent cause, with 10,886 deliberate fires set between 1992-2020, or approximately 1 fire (above 100 acres!) per day, on average.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make table counting causes of the fire -- &quot;NWCG_GENERAL_CAUSE&quot; in the original dataset</span>
<span class="n">dfcausecounts</span> <span class="o">=</span> <span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="c1"># Book keeping for the table column header</span>
<span class="n">dfcausecounts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">:</span> <span class="s1">&#39;Counts&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfcausecounts</span><span class="p">[</span><span class="s1">&#39;Cause of fire&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfcausecounts</span><span class="o">.</span><span class="n">index</span>
<span class="n">dfcausecounts</span> <span class="o">=</span> <span class="n">dfcausecounts</span><span class="p">[[</span><span class="s1">&#39;Cause of fire&#39;</span><span class="p">,</span><span class="s1">&#39;Counts&#39;</span><span class="p">]]</span>

<span class="c1"># Use pandas dataframe styler to make the table</span>
<span class="n">styler</span> <span class="o">=</span> <span class="n">dfcausecounts</span><span class="o">.</span><span class="n">style</span>
<span class="n">styler</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Cause of the largest U.S. wildfires from 1992-2020&quot;</span><span class="p">)</span>
<span class="n">styler</span><span class="o">.</span><span class="n">hide</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">styler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_2623b">
  <caption>Cause of the largest U.S. wildfires from 1992-2020</caption>
  <thead>
    <tr>
      <th id="T_2623b_level0_col0" class="col_heading level0 col0" >Cause of fire</th>
      <th id="T_2623b_level0_col1" class="col_heading level0 col1" >Counts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_2623b_row0_col0" class="data row0 col0" >Natural</td>
      <td id="T_2623b_row0_col1" class="data row0 col1" >19579</td>
    </tr>
    <tr>
      <td id="T_2623b_row1_col0" class="data row1 col0" >Missing data/not specified/undetermined</td>
      <td id="T_2623b_row1_col1" class="data row1 col1" >15774</td>
    </tr>
    <tr>
      <td id="T_2623b_row2_col0" class="data row2 col0" >Arson/incendiarism</td>
      <td id="T_2623b_row2_col1" class="data row2 col1" >10886</td>
    </tr>
    <tr>
      <td id="T_2623b_row3_col0" class="data row3 col0" >Debris and open burning</td>
      <td id="T_2623b_row3_col1" class="data row3 col1" >8125</td>
    </tr>
    <tr>
      <td id="T_2623b_row4_col0" class="data row4 col0" >Equipment and vehicle use</td>
      <td id="T_2623b_row4_col1" class="data row4 col1" >5700</td>
    </tr>
    <tr>
      <td id="T_2623b_row5_col0" class="data row5 col0" >Power generation/transmission/distribution</td>
      <td id="T_2623b_row5_col1" class="data row5 col1" >1428</td>
    </tr>
    <tr>
      <td id="T_2623b_row6_col0" class="data row6 col0" >Recreation and ceremony</td>
      <td id="T_2623b_row6_col1" class="data row6 col1" >1296</td>
    </tr>
    <tr>
      <td id="T_2623b_row7_col0" class="data row7 col0" >Railroad operations and maintenance</td>
      <td id="T_2623b_row7_col1" class="data row7 col1" >980</td>
    </tr>
    <tr>
      <td id="T_2623b_row8_col0" class="data row8 col0" >Smoking</td>
      <td id="T_2623b_row8_col1" class="data row8 col1" >660</td>
    </tr>
    <tr>
      <td id="T_2623b_row9_col0" class="data row9 col0" >Fireworks</td>
      <td id="T_2623b_row9_col1" class="data row9 col1" >445</td>
    </tr>
    <tr>
      <td id="T_2623b_row10_col0" class="data row10 col0" >Misuse of fire by a minor</td>
      <td id="T_2623b_row10_col1" class="data row10 col1" >391</td>
    </tr>
    <tr>
      <td id="T_2623b_row11_col0" class="data row11 col0" >Firearms and explosives use</td>
      <td id="T_2623b_row11_col1" class="data row11 col1" >287</td>
    </tr>
    <tr>
      <td id="T_2623b_row12_col0" class="data row12 col0" >Other causes</td>
      <td id="T_2623b_row12_col1" class="data row12 col1" >123</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="the-growing-strength-of-large-wildfires">
<h2>The growing strength of large wildfires<a class="headerlink" href="#the-growing-strength-of-large-wildfires" title="Permalink to this headline">#</a></h2>
<p>The following figure shows the median, mean, and sum of fire sizes, and the total number of fires, over time, from 1992-2020. In these data, the cyclical, osciallatory behavior of wildfire activity is apparent. Fire presence oscillates between maxima and minimuma over the course of 2-3 year periods. Previous plots demonstrated strong daily and annual cycles in activity, which suggests these super-annual cycles are a result of some larger climate pattern that is decoupled from either annual or daily temperature fluctuations. Alarmingly, all lines with the exception of the total number of fires appear to be gradually increasing. Both the upper and lower bounds of the peaks of the oscillation increase with time. For example, from 1992-1996, the total area affected by wildfire oscillated between ~2 and 4 million acres per year, while the totals from 2016-2020 were between 4 and 10 million.</p>
<p>That the number of fires (yellow) does not follow this trend suggests that larger fires are increasing in relative number. I investigate this possibility in a future figure.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_firesize_overtime</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return arrays/pandas series of median, mean, sum of fire size,</span>
<span class="sd">        and count of number of fires.&quot;&quot;&quot;</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">])[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">])[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">summ</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">])[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">])[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">median</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">summ</span><span class="p">,</span> <span class="n">count</span>
    
<span class="n">med_all</span><span class="p">,</span> <span class="n">mean_all</span><span class="p">,</span> <span class="n">sum_all</span><span class="p">,</span> <span class="n">cnt_all</span> <span class="o">=</span> <span class="n">compute_firesize_overtime</span><span class="p">(</span><span class="n">df_lrg</span><span class="p">)</span>
<span class="c1"># Calling my own plotting routine from accompanying plotting_routines.py</span>
<span class="n">pltrs</span><span class="o">.</span><span class="n">plot_firesize_overtime</span><span class="p">(</span><span class="n">med_all</span><span class="p">,</span> <span class="n">mean_all</span><span class="p">,</span> <span class="n">sum_all</span><span class="p">,</span> <span class="n">cnt_all</span><span class="p">,</span>
                       <span class="s2">&quot;Statistical quantities of full U.S. wildfire sample over time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_12_0.png" src="_images/US_Wildfires_Analysis_12_0.png" />
</div>
</div>
<p>I explore the increasing trend of fire activity more quantitatively using a linear regression analysis on the total or sum of annual surface area affected by fires. I employ a simple ordinary least squares method using the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> package. Plots of the data, the linear fit, and the residuals are below.</p>
<p>The model predicts a slope value of <span class="math notranslate nohighlight">\(m=0.187\pm0.053\)</span>, where the uncertainty here is the standard error from the regression. Given the units of the y-axis, This translates to conclusion that the underlying baseline value around which wildfire activity oscillates is increasing by approximately ~190,000 affected acres per year.</p>
<p>The <span class="math notranslate nohighlight">\(R^2\)</span> value of the fit is 0.314, a rather small value, which is not surprising given the lack of data points clustered near the trendline. As stated before, the natural behavior of the system appears to support osciallations between periods of relatively high and low activity, with a repetition period of ~2-3 years. The residuals display a biomodal distribution with peaks near <span class="math notranslate nohighlight">\(\pm(0.5-1)\)</span> standard deviation. It would be beneficial to extend this dataset to include the extra two years to the current date, or find archival data from before 1992, if possible. I am curious (and worried) to know whether this increase of 190,000 acres of fires per year is compatible with recent data.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">years_sm</span> <span class="o">=</span> <span class="n">sum_all</span><span class="o">.</span><span class="n">index</span>
<span class="n">fire_sum</span> <span class="o">=</span> <span class="n">sum_all</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mf">1e6</span>
<span class="n">yr</span> <span class="o">=</span> <span class="n">years_sm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># add constant term for statsmodels fit</span>
<span class="n">years_sm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">years_sm</span><span class="p">)</span>

<span class="c1"># fit model with Ordinary Least Squares technique</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">fire_sum</span><span class="p">,</span> <span class="n">years_sm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fitparams</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>
<span class="c1">#print(result.summary())</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mf">6.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="c1"># On this axis: Data with linear trend</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sum_all</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">yr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">yr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Sum of wildfire size</span><span class="se">\n</span><span class="s2"> [millions of acres]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Linear fit to total annual wildfire damage&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span>
        <span class="s2">&quot;slope: </span><span class="si">{:.3f}</span><span class="s2">$\pm$</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">bse</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
       <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># On this axis: Residuals, in two units</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">residlim</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
        <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C6&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">yr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">yr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># Units of fire sum (millions of acres)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">residlim</span><span class="p">,</span> <span class="n">residlim</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">yr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Residuals [millions of acres]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Units of standardized residuals</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">residlim</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">mse_resid</span><span class="p">),</span>
              <span class="n">residlim</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">mse_resid</span><span class="p">)])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Standardized residuals (units of std. dv.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

<span class="c1"># On this axis: histogram of residuals</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">residlim</span><span class="p">,</span> <span class="n">residlim</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">residlim</span><span class="p">,</span> <span class="n">residlim</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_14_0.png" src="_images/US_Wildfires_Analysis_14_0.png" />
</div>
</div>
<p>In the below figure, the total sum of surface area affected by wildfires over time is split by the <a class="reference external" href="https://www.nwcg.gov/term/glossary/size-class-of-fire">class</a> representing the fire size. The sum is represented as a ratio to the mean annual total fire size area over the full 1992-2020 period. Values of 1 on the vertical axis thus represent years where the total burn was close the average year, and values of 1.5 represent years where there was 50% more fire area than the average.</p>
<p>When split by fire size class, we can see the largest &gt; 5,000 acre G fires are experiencing a sharper increasing trend over time. Early in the trend, near 1995, the G class fires are oscillating between 25-75% of the mean, while near 2015 they oscillate between 75-175% of the mean. The trend in the D, E, and F class fires is less pronounced.</p>
<p>It is the G class fires that do the most damage in the worst cases cause evacuations of towns and cities. That they are becoming more likely is an unsettling trend.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="n">size_classes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE_CLASS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1"># sorted alphabetically</span>

<span class="c1"># Plot properties for the different classes</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">zorders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ai</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">size_classes</span><span class="p">):</span> <span class="c1"># flip Size Class list to do largest fires first</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df_lrg</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE_CLASS&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">sc</span><span class="p">),[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]]</span>
    <span class="c1"># Use pandas grouby() to sum fire size in each year</span>
    <span class="n">sumfsize</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">])[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sumfsize</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sumfsize</span><span class="p">),</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorders</span><span class="p">[</span><span class="n">ai</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">sc</span><span class="p">)</span>
    <span class="n">ai</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Add a horizontal line at 1.0. This line represents the mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sumfsize</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">sumfsize</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
              <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ratio of annual sum of wildfire size to the average from the full &#39;92-&#39;20 period&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot; U.S. Fire</span><span class="se">\n</span><span class="s2">Size Class&quot;</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">sumfsize</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">sumfsize</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_16_0.png" src="_images/US_Wildfires_Analysis_16_0.png" />
</div>
</div>
</section>
<section id="a-look-at-the-largest-fires-from-2000-2019">
<h2>A look at the largest fires from 2000-2019<a class="headerlink" href="#a-look-at-the-largest-fires-from-2000-2019" title="Permalink to this headline">#</a></h2>
<p>In the following figures, I will focus on the fires between [2000-2009] and [2010-2019], to make a comparison between two decades.</p>
<p>The below table presents the largest fires on record across these two decades, and the following map shows where they occured. The numbers beside each dot denote the rank/order of the fire in the top 10 list, with red colours representing the [2010-2019] decade and blue colours representing [2000-2009].</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab the subset of fires from [2000-2019], then take only the 10 largest</span>
<span class="n">lrgfires_00_20</span> <span class="o">=</span> <span class="n">df_lrg</span><span class="p">[(</span><span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_lrg</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2020</span><span class="p">)]</span>
<span class="n">lrgfires_00_20</span> <span class="o">=</span> <span class="n">lrgfires_00_20</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># For formatting the data and labels in the table</span>
<span class="n">lrgfires_00_20</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">:</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;LATITUDE&#39;</span><span class="p">:</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">lrgfires_00_20</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Size&#39;</span><span class="p">:</span> <span class="s1">&#39;Size (thousands of acres)&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Use pandas dataframe styler to print table</span>
<span class="n">styler</span> <span class="o">=</span> <span class="n">lrgfires_00_20</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Size (thousands of acres)&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">style</span>
<span class="n">styler</span><span class="o">.</span><span class="n">hide</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="n">styler</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Top 10 largest fires in the U.S.A from 2000 to 2019&quot;</span><span class="p">)</span>
<span class="n">styler</span> <span class="o">=</span> <span class="n">display</span><span class="p">(</span><span class="n">styler</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="s1">&#39;white-space&#39;</span><span class="p">:</span> <span class="s1">&#39;pre-wrap&#39;</span><span class="p">,</span>
<span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_b7cbf_row0_col0, #T_b7cbf_row0_col1, #T_b7cbf_row0_col2, #T_b7cbf_row0_col3, #T_b7cbf_row1_col0, #T_b7cbf_row1_col1, #T_b7cbf_row1_col2, #T_b7cbf_row1_col3, #T_b7cbf_row2_col0, #T_b7cbf_row2_col1, #T_b7cbf_row2_col2, #T_b7cbf_row2_col3, #T_b7cbf_row3_col0, #T_b7cbf_row3_col1, #T_b7cbf_row3_col2, #T_b7cbf_row3_col3, #T_b7cbf_row4_col0, #T_b7cbf_row4_col1, #T_b7cbf_row4_col2, #T_b7cbf_row4_col3, #T_b7cbf_row5_col0, #T_b7cbf_row5_col1, #T_b7cbf_row5_col2, #T_b7cbf_row5_col3, #T_b7cbf_row6_col0, #T_b7cbf_row6_col1, #T_b7cbf_row6_col2, #T_b7cbf_row6_col3, #T_b7cbf_row7_col0, #T_b7cbf_row7_col1, #T_b7cbf_row7_col2, #T_b7cbf_row7_col3, #T_b7cbf_row8_col0, #T_b7cbf_row8_col1, #T_b7cbf_row8_col2, #T_b7cbf_row8_col3, #T_b7cbf_row9_col0, #T_b7cbf_row9_col1, #T_b7cbf_row9_col2, #T_b7cbf_row9_col3 {
  text-align: center;
  white-space: pre-wrap;
}
</style>
<table id="T_b7cbf">
  <caption>Top 10 largest fires in the U.S.A from 2000 to 2019</caption>
  <thead>
    <tr>
      <th id="T_b7cbf_level0_col0" class="col_heading level0 col0" >Year</th>
      <th id="T_b7cbf_level0_col1" class="col_heading level0 col1" >Size (thousands of acres)</th>
      <th id="T_b7cbf_level0_col2" class="col_heading level0 col2" >Latitude</th>
      <th id="T_b7cbf_level0_col3" class="col_heading level0 col3" >Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_b7cbf_row0_col0" class="data row0 col0" >2017</td>
      <td id="T_b7cbf_row0_col1" class="data row0 col1" >662.7</td>
      <td id="T_b7cbf_row0_col2" class="data row0 col2" >36.774</td>
      <td id="T_b7cbf_row0_col3" class="data row0 col3" >-100.175</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row1_col0" class="data row1 col0" >2012</td>
      <td id="T_b7cbf_row1_col1" class="data row1 col1" >558.2</td>
      <td id="T_b7cbf_row1_col2" class="data row1 col2" >42.392</td>
      <td id="T_b7cbf_row1_col3" class="data row1 col3" >-117.894</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row2_col0" class="data row2 col0" >2011</td>
      <td id="T_b7cbf_row2_col1" class="data row2 col1" >538.0</td>
      <td id="T_b7cbf_row2_col2" class="data row2 col2" >33.606</td>
      <td id="T_b7cbf_row2_col3" class="data row2 col3" >-109.450</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row3_col0" class="data row3 col0" >2004</td>
      <td id="T_b7cbf_row3_col1" class="data row3 col1" >537.6</td>
      <td id="T_b7cbf_row3_col2" class="data row3 col2" >65.266</td>
      <td id="T_b7cbf_row3_col3" class="data row3 col3" >-146.886</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row4_col0" class="data row4 col0" >2009</td>
      <td id="T_b7cbf_row4_col1" class="data row4 col1" >517.1</td>
      <td id="T_b7cbf_row4_col2" class="data row4 col2" >64.747</td>
      <td id="T_b7cbf_row4_col3" class="data row4 col3" >-149.505</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row5_col0" class="data row5 col0" >2002</td>
      <td id="T_b7cbf_row5_col1" class="data row5 col1" >499.9</td>
      <td id="T_b7cbf_row5_col2" class="data row5 col2" >42.039</td>
      <td id="T_b7cbf_row5_col3" class="data row5 col3" >-123.912</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row6_col0" class="data row6 col0" >2004</td>
      <td id="T_b7cbf_row6_col1" class="data row6 col1" >483.3</td>
      <td id="T_b7cbf_row6_col2" class="data row6 col2" >66.303</td>
      <td id="T_b7cbf_row6_col3" class="data row6 col3" >-149.884</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row7_col0" class="data row7 col0" >2006</td>
      <td id="T_b7cbf_row7_col1" class="data row7 col1" >479.5</td>
      <td id="T_b7cbf_row7_col2" class="data row7 col2" >35.668</td>
      <td id="T_b7cbf_row7_col3" class="data row7 col3" >-101.371</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row8_col0" class="data row8 col0" >2004</td>
      <td id="T_b7cbf_row8_col1" class="data row8 col1" >464.0</td>
      <td id="T_b7cbf_row8_col2" class="data row8 col2" >63.816</td>
      <td id="T_b7cbf_row8_col3" class="data row8 col3" >-143.819</td>
    </tr>
    <tr>
      <td id="T_b7cbf_row9_col0" class="data row9 col0" >2012</td>
      <td id="T_b7cbf_row9_col1" class="data row9 col1" >461.0</td>
      <td id="T_b7cbf_row9_col2" class="data row9 col2" >41.973</td>
      <td id="T_b7cbf_row9_col3" class="data row9 col3" >-118.365</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Make the coloured map using Basemap</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">8000000</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">6500000</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span>
            <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=-</span><span class="mf">107.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">shadedrelief</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawstates</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>

<span class="c1"># Use the basemap object to convert long &amp; lat to x &amp; y co-ords it can use</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">],</span> <span class="n">lrgfires_00_20</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">cnti</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lrgfires_00_20</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">adjx</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    
    <span class="c1"># Manual adjustments for each number label on the map so that the text</span>
    <span class="c1"># does not overlap. Values found via trial and error.</span>
    <span class="c1"># Number in the comment represents the number label i.e. the Fire size rank</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1412216</span><span class="p">):</span>   <span class="c1"># 4</span>
        <span class="n">adjx</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100000</span><span class="p">;</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1474620</span><span class="p">):</span> <span class="c1"># 5</span>
        <span class="n">adjx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="p">;</span>        
    <span class="k">elif</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">643004</span><span class="p">):</span>  <span class="c1"># 8</span>
        <span class="n">adjx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="p">;</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1445525</span><span class="p">):</span> <span class="c1"># 9</span>
        <span class="n">adjx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200000</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250000</span><span class="p">;</span>       
    <span class="k">elif</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2101843</span><span class="p">):</span> <span class="c1"># 10</span>
        <span class="n">adjx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250000</span><span class="p">;</span> <span class="n">adjy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">350000</span><span class="p">;</span>
        
    <span class="c1"># Turn fires from [2000-2009] blue, and [2010-2019] red</span>
    <span class="k">if</span><span class="p">(</span><span class="n">lrgfires_00_20</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2010</span><span class="p">):</span>
        <span class="n">textclr</span> <span class="o">=</span> <span class="s1">&#39;#1e3bfa&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">textclr</span> <span class="o">=</span> <span class="s1">&#39;#e6020e&#39;</span>
               
    <span class="c1"># Add number labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">cnti</span><span class="p">]</span><span class="o">+</span><span class="mi">35000</span><span class="o">+</span><span class="n">adjx</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">cnti</span><span class="p">]</span><span class="o">+</span><span class="mi">35000</span><span class="o">+</span><span class="n">adjy</span><span class="p">,</span>
             <span class="nb">str</span><span class="p">(</span><span class="n">cnti</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">textclr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">cnti</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_19_0.png" src="_images/US_Wildfires_Analysis_19_0.png" />
</div>
</div>
</section>
<section id="comparing-wildfire-occurences-in-alaska-and-the-continential-u-s-a">
<h2>Comparing wildfire occurences in Alaska and the Continential U.S.A.<a class="headerlink" href="#comparing-wildfire-occurences-in-alaska-and-the-continential-u-s-a" title="Permalink to this headline">#</a></h2>
<p>Alaska is unique in this dataset since it is physically separated from the rest of the contiguous United States. Thus, I wished to look at AK and the Con. U.S. individually, to observe the effects of this geographic separation.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new dataframe based on latitude and longitude cuts, separating fires in</span>
<span class="c1"># the continental U.S. from Alaska</span>

<span class="c1"># Continental U.S.</span>
<span class="n">conUS</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LONGITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">130</span><span class="p">)]</span>

<span class="c1"># Alaska</span>
<span class="n">AK</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span>


<span class="c1"># Split both subsets into two decades: [2000-2009] and [2010-2019]</span>
<span class="c1"># Only grab the data/columns needed for future plots</span>

<span class="n">conUS_00_10</span> <span class="o">=</span> <span class="n">conUS</span><span class="p">[(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2010</span><span class="p">)]</span>
<span class="n">conUS_10_20</span> <span class="o">=</span> <span class="n">conUS</span><span class="p">[(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2020</span><span class="p">)]</span>
<span class="n">conUS_00_20</span> <span class="o">=</span> <span class="n">conUS</span><span class="p">[(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2020</span><span class="p">)]</span>

<span class="n">conUS</span> <span class="o">=</span> <span class="n">conUS</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">conUS</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;DISCOVERY_TIME&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_SIZE_CLASS&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]]</span>

<span class="n">AK_00_10</span> <span class="o">=</span> <span class="n">AK</span><span class="p">[(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2010</span><span class="p">)]</span>
<span class="n">AK_10_20</span> <span class="o">=</span> <span class="n">AK</span><span class="p">[(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2020</span><span class="p">)]</span>
<span class="n">AK_00_20</span> <span class="o">=</span> <span class="n">AK</span><span class="p">[(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2020</span><span class="p">)]</span>

<span class="n">AK</span> <span class="o">=</span> <span class="n">AK</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">AK</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;NWCG_GENERAL_CAUSE&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;DISCOVERY_TIME&#39;</span><span class="p">,</span><span class="s1">&#39;FIRE_SIZE_CLASS&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Looking at the same statistical properties as before, but split geographically this time, we see the data for the continental U.S. follow similar trends to the country-wide data, where the mean, median and sum follow gentle upwards trends, while the total number of fires does not.</p>
<p>In Alaska, the story is different. There is no obvious trend in any direction for the data. There are notable peaks above a relatively flat baseline, denoting years of heavy fire presence: 2004, 2005, 2009, 2015. Referencing the table and map from the previous section, the 4th, 7th, and 9th largest fires from the last two decades all occured in 2004 in Alaska.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using previously defined functions from before to produce similar plots for</span>
<span class="c1"># each of the continental U.S. and Alaska subsets</span>

<span class="n">med_cUS</span><span class="p">,</span> <span class="n">mean_cUS</span><span class="p">,</span> <span class="n">sum_cUS</span><span class="p">,</span> <span class="n">cnt_cUS</span> <span class="o">=</span> <span class="n">compute_firesize_overtime</span><span class="p">(</span><span class="n">conUS</span><span class="p">)</span>
<span class="n">med_AK</span><span class="p">,</span>  <span class="n">mean_AK</span><span class="p">,</span>  <span class="n">sum_AK</span><span class="p">,</span>  <span class="n">cnt_AK</span>  <span class="o">=</span> <span class="n">compute_firesize_overtime</span><span class="p">(</span><span class="n">AK</span><span class="p">)</span>

<span class="n">pltrs</span><span class="o">.</span><span class="n">plot_firesize_overtime</span><span class="p">(</span><span class="n">med_cUS</span><span class="p">,</span> <span class="n">mean_cUS</span><span class="p">,</span> <span class="n">sum_cUS</span><span class="p">,</span> <span class="n">cnt_cUS</span><span class="p">,</span>
                      <span class="s2">&quot;Statistical quantities of U.S. wildfire sample over time (Con. U.S.)&quot;</span><span class="p">)</span>
<span class="n">pltrs</span><span class="o">.</span><span class="n">plot_firesize_overtime</span><span class="p">(</span><span class="n">med_AK</span><span class="p">,</span>  <span class="n">mean_AK</span><span class="p">,</span>  <span class="n">sum_AK</span><span class="p">,</span>  <span class="n">cnt_AK</span><span class="p">,</span>
                      <span class="s2">&quot;Statistical quantities of U.S. wildfire sample over time (Alaska)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_23_0.png" src="_images/US_Wildfires_Analysis_23_0.png" />
<img alt="_images/US_Wildfires_Analysis_23_1.png" src="_images/US_Wildfires_Analysis_23_1.png" />
</div>
</div>
<p>Below I split the sum of fire damage over time by class, as before, and compare each region (right panels) to the country-wide data (left panels). As above, the con. U.S. follows a similar trend to the national data, where the G-Class fires exhibit the most dramatic growing trend.</p>
<p>Again, the Alaska data has no strong trend, but the peaks from the above figures are especially clear, now that the data have been normalized to the mean from the time period. The worst years had over 5 times (2004) and nearly 4 times (2015) as much total surface area of wildfires as the average.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Another similar plots to before, but now for each of the continental U.S. and Alaska subsets</span>

<span class="c1"># Calling my own plotting routine from the accompanying plotting_routines.py</span>
<span class="n">pltrs</span><span class="o">.</span><span class="n">plot_firesizeclass_2frame</span><span class="p">(</span><span class="n">conUS</span><span class="p">,</span> <span class="n">df_lrg</span><span class="p">,</span> <span class="s2">&quot;Con. U.S.&quot;</span><span class="p">,</span> <span class="n">size_classes</span><span class="p">)</span>
<span class="n">pltrs</span><span class="o">.</span><span class="n">plot_firesizeclass_2frame</span><span class="p">(</span><span class="n">AK</span><span class="p">,</span> <span class="n">df_lrg</span><span class="p">,</span> <span class="s2">&quot;Alaska&quot;</span><span class="p">,</span> <span class="n">size_classes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_25_0.png" src="_images/US_Wildfires_Analysis_25_0.png" />
<img alt="_images/US_Wildfires_Analysis_25_1.png" src="_images/US_Wildfires_Analysis_25_1.png" />
</div>
</div>
<p>Finally, I look at the spatial distribution of wildfire damage across the con. U.S. and Alaska. Here, each fire (above 100 acres) has been accumulated in (roughly) hexagon-shaped bins, and the colour of the bin represents how much total wildfire (in terms of acres affected) was present in the location represented by the hexagon bin. The first row is for data from [2000-2009], the second row from [2010-2019], and the third row presents the difference between the two, as a percent of the sum of the total wildfire area from [2000-2009].</p>
<p>On these plots, it is obvious the most-affected area of the continental U.S. are the west coast, western interior, north Texas, and Florida. In Alaska, it is primarily the northern interior that is affected by fire. The previously mentioned intense fires between [2000-2009] in Alaska are present in the strong red colours in the upper right panel, and the strong blue colours in the lower right. The latter demonstrates that the [2000-2009] fires in the region were more intense than the fires that occured from [2010-2019].</p>
<p>The percent difference plot for the continentual U.S. shows that most regions in the west experienced an increase in wildfire activity from [2010-2019] compared to [2000-2009]. There are a few regions coloured blue, but most of the map is shaded red. Overall, the midwest and east coast regions are much less affected by wildfires, and are also not experiencing a noticeable shift in fire activity.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining the boundaries of the map</span>
<span class="c1"># lat &amp; long pairs for the lower left and upper right corners, respectively</span>
<span class="n">cUS_corners</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="mi">50</span><span class="p">];</span>
<span class="n">AK_corners</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">65</span><span class="p">]</span>

<span class="c1"># centering lat. and long.</span>
<span class="n">cUS_ll0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">95</span><span class="p">]</span>
<span class="n">AK_ll0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">62.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">155</span><span class="p">]</span>

<span class="c1"># gridsize argument to hexbin for each data set</span>
<span class="c1"># Manually adjusted until land per hex is roughly equal in each</span>
<span class="c1"># map, see prints at the bottom of the cell</span>
<span class="n">cUS_hexgrid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">16</span><span class="p">];</span> <span class="n">AK_hexgrid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">12</span><span class="p">];</span> <span class="n">AK_hexgrid2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span><span class="mi">12</span><span class="p">];</span>

<span class="c1"># colourbar limits</span>
<span class="n">cblimits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000000</span><span class="p">]</span>
<span class="n">cblimits_diff</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">bColourbar</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># normalization by 10 years to get data as # of burned acres per annum.</span>

<span class="c1"># All panels here make use of this routine from the accompanying plotting_routines.py</span>
<span class="n">hex_cUS_00_10</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame</span><span class="p">(</span> <span class="n">conUS_00_10</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">cUS_corners</span><span class="p">,</span> <span class="n">cUS_ll0</span><span class="p">,</span> <span class="n">cUS_hexgrid</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[2000-2009]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">bColourbar</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">hex_AK_00_10</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame</span><span class="p">(</span> <span class="n">AK_00_10</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">AK_corners</span><span class="p">,</span> <span class="n">AK_ll0</span><span class="p">,</span> <span class="n">AK_hexgrid</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># Check that the sum of hexbin 2D histogram values equals</span>
<span class="sd"># the sum of the FIRE_SIZE from the raw data</span>
<span class="sd"># From this print I caught that the default function hexbin()</span>
<span class="sd"># uses to ammalgamate colour values is mean(), not sum()!</span>
<span class="sd">print(&quot;sum check:&quot;, AK_00_10[&#39;FIRE_SIZE&#39;].sum()/norm,</span>
<span class="sd">      np.sum(hex_AK_00_10.get_array()))</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">hex_cUS_10_20</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame</span><span class="p">(</span> <span class="n">conUS_10_20</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">cUS_corners</span><span class="p">,</span> <span class="n">cUS_ll0</span><span class="p">,</span> <span class="n">cUS_hexgrid</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[2010-2019]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">hex_AK_10_20</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame</span><span class="p">(</span> <span class="n">AK_10_20</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">AK_corners</span><span class="p">,</span> <span class="n">AK_ll0</span><span class="p">,</span> <span class="n">AK_hexgrid2</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits</span><span class="p">)</span>

<span class="n">bColourbar</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">norm</span> <span class="o">=</span> <span class="n">conUS_00_10</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># normalize by sum of all fires from &#39;00-&#39;09, to get % change</span>
<span class="n">hdiff_cUS</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame_diff</span><span class="p">(</span> <span class="n">conUS_00_20</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">cUS_corners</span><span class="p">,</span> <span class="n">cUS_ll0</span><span class="p">,</span> <span class="n">cUS_hexgrid</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits_diff</span><span class="p">)</span>

<span class="n">bColourbar</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">AK_00_10</span><span class="p">[</span><span class="s1">&#39;FIRE_SIZE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># normalize by sum of all fires from &#39;00-&#39;09, to get % change</span>
<span class="n">hdiff_AK</span> <span class="o">=</span> <span class="n">pltrs</span><span class="o">.</span><span class="n">plot_hexbin_frame_diff</span><span class="p">(</span> <span class="n">AK_00_20</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
    <span class="n">AK_corners</span><span class="p">,</span> <span class="n">AK_ll0</span><span class="p">,</span> <span class="n">AK_hexgrid</span><span class="p">,</span>
    <span class="n">bColourbar</span><span class="p">,</span> <span class="n">cblimits_diff</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">AK_area = 0.663 # Million sq. mi.</span>
<span class="sd">cUS_area = 3.119 # Million sq. mi.</span>
<span class="sd">print(&quot;Hex and Area ratios:&quot;)</span>
<span class="sd">print(&quot;Land Area: {:.3f} ; Con. US.: {:.3f} ; Alaska(1): {:.3f}; Alaska(2): {:.3f}&quot;.</span>
<span class="sd">      format( cUS_area/AK_area,</span>
<span class="sd">    hex_cUS_00_10.get_array().shape[0]/hex_cUS_10_20.get_array().shape[0],</span>
<span class="sd">    hex_cUS_00_10.get_array().shape[0]/hex_AK_00_10.get_array().shape[0],</span>
<span class="sd">    hex_cUS_00_10.get_array().shape[0]/hex_AK_10_20.get_array().shape[0]))</span>
<span class="sd"># Wanted to confirm the hexes in both plots represent roughly the same area</span>
<span class="sd"># Checking that ratio of land area is (roughly) same to ratio of number of hexes</span>
<span class="sd"># Played with the hex grid variables until this was true</span>
<span class="sd"># It&#39;s not perfect; not all hexes are the same size between maps, clearly</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/US_Wildfires_Analysis_27_0.png" src="_images/US_Wildfires_Analysis_27_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>